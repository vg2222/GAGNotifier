<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>üåº Garden Data Tracker</title>
  <style>
    /* –û–±—â–∏–µ —Å—Ç–∏–ª–∏ */
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      padding: 20px;
      background: #0d0f1a;
      color: #ffffff;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    h1 {
      text-align: center;
      font-size: 2rem;
      margin-bottom: 30px;
      color: #72e2ae;
      animation: fadeIn 1s ease;
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∫–∞—Ä—Ç–æ—á–µ–∫ */
    #content {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
    }

    /* –°—Ç–∏–ª–∏ –¥–ª—è –æ–¥–Ω–æ–π –∫–∞—Ä—Ç–æ—á–∫–∏ –∏–≥—Ä–æ–∫–∞ */
    .card {
      background: #1a1c2e;
      border-radius: 12px;
      padding: 20px;
      box-shadow: 0 0 15px rgba(0, 0, 0, 0.4);
      animation: slideUp 0.4s ease;
      display: flex;
      flex-direction: column;
    }

    /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ –∫–∞—Ä—Ç–æ—á–∫–∏ */
    .player-name {
      font-size: 1.4rem;
      font-weight: 600;
      color: #ffd369;
      margin-bottom: 10px;
    }

    /* –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –ø–æ–≥–æ–¥—ã */
    .weather {
      font-size: 1rem;
      margin-bottom: 15px;
    }
    .weather .label {
      font-weight: 500;
      color: #72e2ae;
    }

    /* –°–µ–∫—Ü–∏—è —Å –ø—Ä–µ–¥–º–µ—Ç–∞–º–∏ */
    .section {
      margin-top: 15px;
    }
    .section-title {
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 8px;
      color: #72e2ae;
    }

    /* –°–µ—Ç–∫–∞ –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤–Ω—É—Ç—Ä–∏ —Å–µ–∫—Ü–∏–∏ */
    .items-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
      gap: 10px;
    }

    .item-box {
      background: #25273d;
      border-radius: 8px;
      padding: 8px;
      text-align: center;
      font-size: 0.95rem;
      line-height: 1.2rem;
      position: relative;
      animation: fadeIn 0.5s ease;
    }
    .item-box .name {
      display: block;
      font-weight: 500;
      margin-bottom: 4px;
      color: #ffffff;
    }
    .item-box .qty {
      display: block;
      font-size: 0.9rem;
      color: #ffd369;
    }

    /* –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è */
    .timestamp {
      text-align: center;
      margin-top: 30px;
      color: #aaaaaa;
      font-size: 0.9rem;
    }

    /* –ê–Ω–∏–º–∞—Ü–∏–∏ */
    @keyframes slideUp {
      from { transform: translateY(20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
  </style>
</head>
<body>
  <h1>üåº Garden Data Tracker</h1>
  <div id="content">
    <!-- –°—é–¥–∞ JS –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –≤—Å—Ç–∞–≤–∏—Ç –∫–∞—Ä—Ç–æ—á–∫–∏ –∫–∞–∂–¥–æ–≥–æ –∏–≥—Ä–æ–∫–∞ -->
  </div>
  <div class="timestamp" id="timestamp"></div>

  <script>
    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏ –æ—Ç—Ä–∏—Å–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö
    async function loadData() {
      try {
        const res = await fetch('/api/data');
        const data = await res.json();
        const content = document.getElementById('content');
        const timestamp = document.getElementById('timestamp');

        content.innerHTML = ''; // –û—á–∏—â–∞–µ–º —Å—Ç–∞—Ä—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏

        if (!Array.isArray(data) || data.length === 0) {
          content.innerHTML = '<p style="text-align:center; color:#ccc;">No data available.</p>';
        } else {
          data.forEach(entry => {
            // –§–∏–ª—å—Ç—Ä—É–µ–º gear/ seeds / eggs / honeyevent –ø–æ qty > 0
            const gearItems = Object.entries(entry.gear || {})
              .filter(([name, qty]) => parseInt(qty) > 0);
            const seedItems = Object.entries(entry.seeds || {})
              .filter(([name, qty]) => parseInt(qty) > 0);
            const eggItems = Object.entries(entry.eggs || {})
              .filter(([name, qty]) => parseInt(qty) > 0);
            // honeyevent —É–∂–µ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ —Ä–µ–¥–∫–∏–µ —Å qty > 0
            const honeyItems = Object.entries(entry.honeyevent || {});

            // –°–æ–±–∏—Ä–∞–µ–º HTML –¥–ª—è –∫–∞—Ä—Ç–æ—á–∫–∏
            const card = document.createElement('div');
            card.className = 'card';

            // 1. –ò–º—è –∏–≥—Ä–æ–∫–∞
            const nameEl = document.createElement('div');
            nameEl.className = 'player-name';
            nameEl.textContent = entry.player || 'Unknown Player';
            card.appendChild(nameEl);

            // 2. –¢–µ–∫—É—â–∞—è –ø–æ–≥–æ–¥–∞
            const weatherEl = document.createElement('div');
            weatherEl.className = 'weather';
            weatherEl.innerHTML = `<span class="label">Weather:</span> ${entry.weather || 'Unknown'}`;
            card.appendChild(weatherEl);

            // 3. –°–µ–∫—Ü–∏—è: Gear (–µ—Å–ª–∏ –µ—Å—Ç—å)
            if (gearItems.length > 0) {
              const secGear = document.createElement('div');
              secGear.className = 'section';
              secGear.innerHTML = `<div class="section-title">üß∞ Gear</div>`;
              const gridGear = document.createElement('div');
              gridGear.className = 'items-grid';
              gearItems.forEach(([name, qty]) => {
                const box = document.createElement('div');
                box.className = 'item-box';
                box.innerHTML = `
                  <span class="name">${name}</span>
                  <span class="qty">${qty}</span>
                `;
                gridGear.appendChild(box);
              });
              secGear.appendChild(gridGear);
              card.appendChild(secGear);
            }

            // 4. –°–µ–∫—Ü–∏—è: Seeds (–µ—Å–ª–∏ –µ—Å—Ç—å)
            if (seedItems.length > 0) {
              const secSeeds = document.createElement('div');
              secSeeds.className = 'section';
              secSeeds.innerHTML = `<div class="section-title">üå± Seeds</div>`;
              const gridSeeds = document.createElement('div');
              gridSeeds.className = 'items-grid';
              seedItems.forEach(([name, qty]) => {
                const box = document.createElement('div');
                box.className = 'item-box';
                box.innerHTML = `
                  <span class="name">${name}</span>
                  <span class="qty">${qty}</span>
                `;
                gridSeeds.appendChild(box);
              });
              secSeeds.appendChild(gridSeeds);
              card.appendChild(secSeeds);
            }

            // 5. –°–µ–∫—Ü–∏—è: Eggs (–µ—Å–ª–∏ –µ—Å—Ç—å)
            if (eggItems.length > 0) {
              const secEggs = document.createElement('div');
              secEggs.className = 'section';
              secEggs.innerHTML = `<div class="section-title">ü•ö Eggs</div>`;
              const gridEggs = document.createElement('div');
              gridEggs.className = 'items-grid';
              eggItems.forEach(([name, qty]) => {
                const box = document.createElement('div');
                box.className = 'item-box';
                box.innerHTML = `
                  <span class="name">${name}</span>
                  <span class="qty">${qty}</span>
                `;
                gridEggs.appendChild(box);
              });
              secEggs.appendChild(gridEggs);
              card.appendChild(secEggs);
            }

            // 6. –°–µ–∫—Ü–∏—è: Rare HoneyEvent Items (–µ—Å–ª–∏ –µ—Å—Ç—å)
            if (honeyItems.length > 0) {
              const secHoney = document.createElement('div');
              secHoney.className = 'section';
              secHoney.innerHTML = `<div class="section-title">üçØ Rare HoneyEvent Items</div>`;
              const gridHoney = document.createElement('div');
              gridHoney.className = 'items-grid';
              honeyItems.forEach(([name, qty]) => {
                const box = document.createElement('div');
                box.className = 'item-box';
                box.innerHTML = `
                  <span class="name">${name}</span>
                  <span class="qty">${qty}</span>
                `;
                gridHoney.appendChild(box);
              });
              secHoney.appendChild(gridHoney);
              card.appendChild(secHoney);
            }

            // –ï—Å–ª–∏ –Ω–∏ –≤ –æ–¥–Ω–æ–π –∏–∑ —Å–µ–∫—Ü–∏–π –Ω–µ—Ç —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –º–æ–∂–Ω–æ –≤—ã–≤–µ—Å—Ç–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ:
            if (
              gearItems.length === 0 &&
              seedItems.length === 0 &&
              eggItems.length === 0 &&
              honeyItems.length === 0
            ) {
              const noData = document.createElement('div');
              noData.style.marginTop = '10px';
              noData.style.color = '#cccccc';
              noData.textContent = 'No items with quantity > 0.';
              card.appendChild(noData);
            }

            content.appendChild(card);
          });
        }

        // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–∞–π–º—à—Ç–∞–º–ø
        const now = new Date();
        timestamp.textContent = `Last updated: ${now.toLocaleString()}`;
      } catch (err) {
        document.getElementById('content').innerHTML =
          '<p style="text-align:center; color:#e74c3c;">Error loading data</p>';
        console.error(err);
      }
    }

    loadData();
    setInterval(loadData, 60000); // –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞—Ç—å –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
  </script>
</body>
</html>
